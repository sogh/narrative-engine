# Prompt Log — 2026-02-21

## Entry 1

**Time:** 2026-02-21
**Prompt:** "Take a look at the updated CLAUDE.md and then review the to-do folder and begin work."

**Context:** CLAUDE.md has been fully populated with project overview, tech stack, project structure, architecture principles, coding conventions, RON data format conventions, common tasks, and what-not-to-do guidelines. The to-do folder contains `implementation_prompts.md` with 14 sequential prompts (Prompt 0 through Prompt 13). Starting with Prompt 0: Project Scaffolding.

**Work — Prompt 0: Project Scaffolding (COMPLETE):**
- Created `Cargo.toml` with dependencies: `serde` (with derive), `ron` 0.8, `rand` 0.8, `rustc-hash` 2, `thiserror` 2. Binary targets for `corpus_trainer`, `grammar_linter`, `preview`. Example targets for `dinner_party`, `jurassic_park`.
- Created full module hierarchy under `src/`:
  - `lib.rs` — public re-exports of `schema`, `core`, `genre_templates`
  - `schema/` — `entity.rs` (EntityId, VoiceId, Value, Entity), `event.rs` (Mood, Stakes, Outcome, EntityRef, Event), `narrative_fn.rs` (NarrativeFunction enum with 10 core + Custom), `relationship.rs` (Relationship)
  - `core/` — `pipeline.rs` (NarrativeEngine placeholder), `grammar.rs` (GrammarSet, GrammarRule, Alternative), `markov.rs` (MarkovModel placeholder), `voice.rs` (Voice, VoiceRegistry placeholder), `context.rs` (NarrativeContext placeholder), `variety.rs` (VarietyPass placeholder)
  - `genre_templates/` — placeholder modules for social_drama, survival_thriller, political_intrigue, exploration
- Created `tools/` with placeholder binaries for all three tools
- Created `genre_data/` directories for all four genres (with .gitkeep)
- Created `tests/fixtures/test_grammar.ron` (3 rules: greeting, tense_observation, action_detail)
- Created `tests/fixtures/test_corpus.txt` (10 sentences across [neutral], [tense], [warm] tags)
- Created `tests/` integration test files (grammar_tests.rs, markov_tests.rs, pipeline_tests.rs)
- Created `examples/` with placeholder dinner_party.rs and jurassic_park.rs
- Copied design doc to `docs/design.md`
- `cargo build` succeeds, `cargo test` passes all 17 tests (14 unit + 3 integration)

## Entry 2

**Time:** 2026-02-21
**Prompt:** "Please continue through each prompt sequentially. Commit your work now and after each prompt, but then continue work without asking until you run out of prompts."

**Work — Prompts 1-10 (COMPLETE):**
All prompts were implemented sequentially with a commit after each:
- **Prompt 1: Schema Layer** — Entity, Event, NarrativeFunction, Relationship types with RON serialization
- **Prompt 2: Grammar Data Model** — GrammarSet, GrammarRule, Alternative, Template, TemplateSegment types with RON parsing
- **Prompt 3: Grammar Expansion Runtime** — Recursive expansion engine with tag propagation, weighted selection, entity/pronoun resolution
- **Prompt 4: Voice System** — Voice, VoiceRegistry with inheritance resolution, RON loading
- **Prompt 5: Markov Chain Generator** — MarkovTrainer, MarkovModel with tagged regions, blending, n-gram support
- **Prompt 6: Context and Variety System** — NarrativeContext anti-repetition, VarietyPass synonym rotation/quirk injection
- **Prompt 7: Pipeline Integration** — NarrativeEngine with builder pattern, narrate/narrate_as/narrate_variants API
- **Prompt 8: Social Drama Genre Template** — Grammar rules (Revelation, Confrontation, Betrayal, Alliance, ComicRelief), 4 voices, corpus
- **Prompt 9: Survival Thriller Genre Template** — Grammar rules (Escalation, Discovery, Loss, Foreshadowing, StatusChange), 4 voices, corpus
- **Prompt 10: Grammar Linter Tool** — tools/grammar_linter.rs with coverage/quality/reference/cycle checks

## Entry 3

**Time:** 2026-02-21
**Prompt:** (Continuation from previous session — context was compacted)

**Work — Prompts 11-13 (COMPLETE):**
- **Prompt 11: Preview Tool** — Interactive REPL shell in tools/preview.rs with event/voice/entity/seed/bulk/help/quit commands, expansion trace output, variety statistics for bulk generation
- **Prompt 12: Dinner Party Example** — examples/dinner_party.rs with 5 entities (Margaret, James, Eleanor, Robert, dining room) and 7 scenes using Social Drama template (Alliance, Confrontation, Revelation, ComicRelief, Betrayal)
- **Prompt 13: Jurassic Park Example** — examples/jurassic_park.rs with 7 entities (Grant, Malcolm, Muldoon, Control Room, Rex Paddock, Raptor Pen, Security System) and 7 scenes using Survival Thriller template, alternating radio_operator and narrator_omniscient voices

**All 14 prompts complete.** Moved `to-do/implementation_prompts.md` to `done-work/`. Final test count: 106 tests passing, 0 warnings.
